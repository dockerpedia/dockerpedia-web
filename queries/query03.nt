#shows the vulnerabilities of image

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX w3: <http://www.w3.org/2000/01/rdf-schema#>

PREFIX docker: <http://www.w3.org/ns/bde/docker/>
PREFIX purl: <http://www.purl.org/net/wicus-stack#>
PREFIX is: <http://purl.org/ontology/is/core#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX voc: <http://voc.odw.tw/>

prefix vocab: <http://dockerpedia.inf.utfsm.cl/vocab#>
prefix ex: <http://dockerpedia.inf.utfsm.cl/resource/>
prefix exdata: <http://dockerpedia.inf.utfsm.cl/data/>


SELECT ?packagename ?packageversionnumber ?vulnerabilityname ?severity

WHERE {
  ?image vocab:id 62434 .
  ?image vocab:hasLayer ?layer .
  ?modification vocab:modifiedLayer ?layer .
  ?modification vocab:relatedPackage ?packageversion .
  ?package vocab:hasVersion ?packageversion .
  ?package w3:label ?packagename .
  ?packageversion w3:label ?packageversionnumber .
  ?packageversion vocab:hasVulnerability ?vulnerability.
  ?vulnerability rdfs:label ?vulnerabilityname .
  ?vulnerability vocab:severity ?severity
} limit 10000